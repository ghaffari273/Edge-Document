# ارسال پیامک با فایل

این API به شما امکان ارسال پیام با استفاده از فایل حاوی شماره تلفن‌های گیرندگان را می‌دهد.

## 📍 لینک دسترسی

```
POST {base_url}/api/send
```

## 🧾 هدرها

| کلید          | مقدار               |
|---------------|---------------------|
| Authorization | توکن یا کلید دسترسی |
| Content-Type  | multipart/form-data |

## 📤 بدنه درخواست

```json
{
  "sending_type": "file",
  "from_number": "+983000505",
  "message": "متن پیام",
  "files[]": "file.csv",
  "send_time": "2025-03-12 21:20:02",
  "other_recipients": [
    "+989120000000",
    "+989350000000"
  ]
}
```

## 📝 پارامترها

| پارامتر          | نوع    | ضروری | توضیحات                                                                                                         |
|------------------|--------|-------|-----------------------------------------------------------------------------------------------------------------|
| sending_type     | string | بله   | نوع ارسال، باید "file" باشد                                                                                     |
| from_number      | string | بله   | شماره فرستنده در فرمت E.164 (مثال: +983000505)                                                                  |
| message          | string | بله   | متن پیامی که میخواهید ارسال نمایید. این متن نباید بیش از 1400 کارکتر یا 20 پارت باشد                            |
| files[]          | file   | بله   | فایل حاوی شماره تلفن‌ گیرندگان، باید در فرمت CSV یا XLSX باشد. حداکثر تعداد مجاز گیرنده یک میلیون شماره می باشد |
| send_time        | string | خیر   | زمان مورد نظر برای ارسال پیام در فرمت YYYY-MM-DD HH:MM:SS. منطقه زمانی UTC است.                                 |
| other_recipients | array  | خیر   | گیرندگان اضافی در فرمت E.164 (مثال: +989120000000)                                                              |

### فرمت فایل

فایل آپلود شده باید شماره تلفن‌ها را در فرمت زیر شامل شود:

#### فرمت CSV

```
phone_number
09123456789
09123456788
09123456787
```

#### فرمت اکسل

فایل اکسل باید یک ستون داشته باشد:

- ستون A: شماره تلفن‌ها

## 📝 نکات

- `from_number` باید سرشماره معتبری باشد که به حساب شما اختصاص یافته است.
- `send_time` اختیاری است؛ اگر ارائه نشود، پیام فوراً ارسال خواهد شد.
- پارامتر `files[]` باید شامل فایل معتبری با شماره تلفن‌ها باشد. فایل می‌تواند در فرمت CSV یا XLSX باشد.
- آرایه `other_recipients` اختیاری است و می‌تواند برای افزودن گیرندگان اضافی که در فایل گنجانده نشده‌اند استفاده شود.
- شماره تلفن‌ها می‌توانند در فرمت محلی (09xxxxxxxxx) یا بین‌المللی (+98xxxxxxxxx) باشند.

## ✅ پاسخ موفق

```json
{
  "data": {
    "message_outbox_ids": [
      1123544244
    ]
  },
  "meta": {
    "status": true,
    "message": "انجام شد",
    "message_parameters": [],
    "message_code": "200-1"
  }
}
```

## ❌ پاسخ خطا — فایل نامعتبر (422)

```json
{
  "data": null,
  "meta": {
    "status": false,
    "message": "فرمت فایل پشتیبانی نمی‌شود",
    "message_parameters": [],
    "message_code": "400-2",
    "errors": {
      "files": [
        "فرمت فایل پشتیبانی نمی‌شود"
      ]
    }
  }
}
```

## 🧪 نمونه درخواست

```bash
curl --location '{base_url}/api/send' \
--header 'Authorization: API TOKEN' \
--form 'sending_type="file"' \
--form 'from_number="+983000505"' \
--form 'message="متن پیام"' \
--form 'files[]=@"path/to/your/file.csv"' \
--form 'send_time="2025-03-12 21:20:02"'
```
