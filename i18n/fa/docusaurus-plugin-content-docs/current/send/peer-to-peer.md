# ارسال پیامک نظیر به نظیر

این API به شما امکان ارسال چندین پیام به چندین گیرنده در قالب نظیر به نظیر را می‌دهد. هر پیام می‌تواند مجموعه گیرندگان
خاص خود را داشته باشد.

## 📍 لینک دسترسی

```
POST {base_url}/api/send
```

## 🧾 هدرهای درخواست

| کلید          | مقدار               |
|---------------|---------------------|
| Authorization | توکن یا کلید دسترسی |
| Content-Type  | application/json    |

## 📤 بدنه درخواست

```json
{
  "sending_type": "peer_to_peer",
  "from_number": "+983000505",
  "params": [
    {
      "recipients": [
        "+989120000000",
        "+989350000000"
      ],
      "message": "پیام اول"
    },
    {
      "recipients": [
        "+989130000000"
      ],
      "message": "پیام دوم"
    }
  ]
}
```

## 📝 پارامترها

| پارامتر      | نوع    | ضروری | توضیحات                                                                              |
|--------------|--------|-------|--------------------------------------------------------------------------------------|
| sending_type | string | بله   | نوع ارسال، باید "peer_to_peer" باشد                                                  |
| from_number  | string | بله   | شماره فرستنده در فرمت E.164 (مثال: +983000505)                                       |
| params       | array  | بله   | آرایه‌ای از اشیاء شامل گیرندگان و پیام‌ها                                            |
| recipients   | array  | بله   | لیست شماره تلفن گیرندگان در فرمت E.164 (مثال: +989120000000)                         |
| message      | string | بله   | متن پیامی که میخواهید ارسال نمایید. این متن نباید بیش از 1400 کارکتر یا 20 پارت باشد |
| send_time    | string | خیر   | زمان مورد نظر برای ارسال پیام در فرمت YYYY-MM-DD HH:MM:SS. منطقه زمانی UTC است.      |

## 📝 نکات

- `from_number` باید سرشماره معتبری باشد که به حساب شما اختصاص یافته است.
- هر شی در آرایه `params` می‌تواند گیرندگان و پیام منحصر به فرد خود را داشته باشد.
- تمام شماره تلفن‌ها باید در فرمت E.164 باشند.

## ✅ پاسخ موفق

```json
{
  "data": {
    "message_outbox_ids": [
      1123544244,
      1123544245
    ]
  },
  "meta": {
    "status": true,
    "message": "انجام شد",
    "message_parameters": [],
    "message_code": "200-1"
  }
}
```

## ❌ پاسخ خطا — توکن یا کلید دسترسی نامعتبر یا منقضی شده (401)

```json
{
  "data": null,
  "meta": {
    "status": false,
    "message": "اطلاعات وارد شده صحیح نمی باشد",
    "message_parameters": [],
    "message_code": "400-1",
    "errors": {}
  }
}
```

## ❌ پاسخ خطا — درخواست نامعتبر (422)

```json
{
  "data": null,
  "meta": {
    "status": false,
    "message": "تکمیل گزینه پیام الزامی است",
    "message_parameters": [],
    "message_code": "400-2",
    "errors": {
      "message": [
        "تکمیل گزینه پیام الزامی است"
      ]
    }
  }
}
```

## 🧪 نمونه درخواست

```bash
curl --location '{base_url}/api/send' \
--header 'Content-Type: application/json' \
--header 'Authorization: API TOKEN' \
--data '{
    "sending_type": "peer_to_peer",
    "from_number": "+983000505",
    "params": [
        {
            "recipients": [
                "+989120000000",
                "+989350000000"
            ],
            "message": "پیام اول"
        },
        {
            "recipients": [
                "+989130000000"
            ],
            "message": "پیام دوم"
        }
    ]
}'
```
