# ارسال پیامک نظیر به نظیر با فایل

این API به شما امکان ارسال چندین پیام به چندین گیرنده در قالب نظیر به نظیر با استفاده از فایل را می‌دهد. هر پیام
می‌تواند مجموعه گیرندگان خاص خود را داشته باشد.

## 📍 لینک دسترسی

```
POST {base_url}/api/send
```

## 🧾 هدرهای درخواست

| کلید          | مقدار               |
|---------------|---------------------|
| Authorization | توکن یا کلید دسترسی |
| Content-Type  | multipart/form-data |

## 📤 بدنه درخواست

```json
{
  "sending_type": "peer_to_peer_file",
  "from_number": "+983000505",
  "send_time": "2025-03-12 21:20:02",
  "files[]": "file.csv"
}
```

این درخواست از فرمت `multipart/form-data` برای مدیریت آپلود فایل استفاده می‌کند.

| پارامتر      | نوع    | ضروری | توضیحات                                                                             |
|--------------|--------|-------|-------------------------------------------------------------------------------------|
| sending_type | string | بله   | نوع ارسال، باید "peer_to_peer_file" باشد                                            |
| from_number  | string | بله   | شماره فرستنده در فرمت E.164 (مثال: +983000505)                                      |
| send_time    | string | خیر   | زمان مورد نظر برای ارسال پیام در فرمت YYYY-MM-DD HH:MM:SS. منطقه زمانی UTC است.     |
| files[]      | file   | بله   | فایل شامل شماره گیرندگان و پیام‌های شخصی‌سازی شده. فرمت‌های پشتیبانی شده: CSV، XLSX |

### فرمت فایل

فایل آپلود شده باید از این فرمت پیروی کند:

#### فرمت CSV

```
recipient,message
09123456789,پیام شخصی‌سازی شده برای گیرنده اول
09123456788,پیام شخصی‌سازی شده برای گیرنده دوم
09123456787,پیام شخصی‌سازی شده برای گیرنده سوم
```

#### فرمت اکسل

فایل اکسل باید دو ستون داشته باشد:

- ستون A: شماره گیرندگان
- ستون B: پیام‌های مربوط به هر گیرنده

## 📝 نکات

- `from_number` باید سرشماره معتبری باشد که به حساب شما اختصاص یافته است.
- فایل باید حداکثر 10000 ردیف داشته باشد.
- شماره تلفن‌ها می‌توانند در فرمت محلی (09xxxxxxxxx) یا بین‌المللی (+98xxxxxxxxx) باشند.
- هر ردیف در فایل یک پیام جداگانه را نمایندگی می‌کند و کد پیگیری خاص خود را خواهد داشت

## ✅ پاسخ موفق

```json
{
  "data": {
    "message_outbox_ids": [
      1123544244,
      1123544245,
      1123544246
    ]
  },
  "meta": {
    "status": true,
    "message": "انجام شد",
    "message_parameters": [],
    "message_code": "200-1"
  }
}
```

## ❌ پاسخ خطا — فایل نامعتبر (422)

```json
{
  "data": null,
  "meta": {
    "status": false,
    "message": "فرمت فایل پشتیبانی نمی‌شود",
    "message_parameters": [],
    "message_code": "400-2",
    "errors": {
      "files": [
        "فرمت فایل پشتیبانی نمی‌شود"
      ]
    }
  }
}
```

## 🧪 نمونه درخواست

```bash
curl --location '{base_url}/api/send' \
--header 'Authorization: API TOKEN' \
--form 'sending_type="peer_to_peer_file"' \
--form 'from_number="+983000505"' \
--form 'send_time="2025-03-12 21:20:02"' \
--form 'files[]=@"path/to/your/file.csv"'
```
