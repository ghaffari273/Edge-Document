# ارسال پیامک کلمه کلیدی دفترچه تلفن

این API به شما امکان ارسال پیام با استفاده از کلمه کلیدی به دفترچه تلفن را می‌دهد.

## 📍 لینک دسترسی

```
POST {base_url}/api/send
```

## 🧾 هدرهای درخواست

| کلید          | مقدار               |
|---------------|---------------------|
| Authorization | توکن یا کلید دسترسی |
| Content-Type  | application/json    |

## 📤 بدنه درخواست

```json
{
  "sending_type": "keyword_phonebook",
  "from_number": "+983000505",
  "message": "تاریخ {ex_50856}\nبدهی {ex_50858}",
  "send_time": "2025-03-25 10:10:10",
  "params": [
    {
      "phonebook_id": 123654
    }
  ]
}
```

## 📝 پارامترهای درخواست

| پارامتر      | نوع     | ضروری | توضیحات                                                                         |
|--------------|---------|-------|---------------------------------------------------------------------------------|
| sending_type | string  | بله   | نوع ارسال، باید "keyword_phonebook" باشد                                        |
| from_number  | string  | بله   | شماره فرستنده در فرمت E.164 (مثال: +983000505)                                  |
| message      | string  | بله   | محتوای پیام برای ارسال، می‌تواند شامل جای‌گذارها برای فیلدهای دفترچه تلفن باشد  |
| send_time    | string  | خیر   | زمان مورد نظر برای ارسال پیام در فرمت YYYY-MM-DD HH:MM:SS. منطقه زمانی UTC است. |
| params       | array   | بله   | آرایه‌ای از اشیاء شامل شناسه دفترچه تلفن                                        |
| phonebook_id | integer | بله   | شناسه دفترچه تلفن برای ارسال پیام                                               |

## 📝 جای‌گذارهای دفترچه تلفن

می‌توانید از فیلدهای تعریف شده در دفترچه تلفن به عنوان جای‌گذار در پیام خود استفاده کنید:

- `{ex_FIELD_ID}`: جای‌گذار برای فیلد اختیاری با شناسه مشخص
- مثال: اگر فیلد "تاریخ" شناسه 50856 داشته باشد، می‌توانید از `{ex_50856}` استفاده کنید

## 📝 نکات

- `from_number` باید سرشماره معتبری باشد که به حساب شما اختصاص یافته است.
- `send_time` اختیاری است؛ اگر ارائه نشود، پیام فوراً ارسال خواهد شد.
- دفترچه تلفن باید از قبل در سیستم تعریف شده باشد.
- جای‌گذارها باید با شناسه فیلدهای تعریف شده در دفترچه تلفن مطابقت داشته باشند.

## ✅ پاسخ موفق

```json
{
  "data": {
    "message_outbox_ids": [
      1123544244
    ]
  },
  "meta": {
    "status": true,
    "message": "انجام شد",
    "message_parameters": [],
    "message_code": "200-1"
  }
}
```

## ❌ پاسخ خطا — دفترچه تلفن یافت نشد (404)

```json
{
  "data": null,
  "meta": {
    "status": false,
    "message": "دفترچه تلفن یافت نشد",
    "message_parameters": [],
    "message_code": "404-1",
    "errors": {}
  }
}
```

## 🧪 نمونه درخواست

```bash
curl --location '{base_url}/api/send' \
--header 'Content-Type: application/json' \
--header 'Authorization: API TOKEN' \
--data '{
    "sending_type": "keyword_phonebook",
    "from_number": "+983000505",
    "message": "تاریخ {ex_50856}\nبدهی {ex_50858}",
    "send_time": "2025-03-25 10:10:10",
    "params": [
        {
            "phonebook_id": 123654
        }
    ]
}'
```
