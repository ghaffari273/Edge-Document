# ارسال پیامک با کلمه کلیدی

این API به شما امکان ارسال پیام با استفاده از کلمه کلیدی را می‌دهد.

ارسال کلمات کلیدی بدین معناست که هر پیام میتواند شامل متغیری باشد که مقدار آن باید از مقادیر مشخض شده جایگذاری گردد.

## 📍 لینک دسترسی

```
POST {base_url}/api/send
```

## 🧾 هدرهای درخواست

| کلید          | مقدار               |
|---------------|---------------------|
| Authorization | توکن یا کلید دسترسی |
| Content-Type  | multipart/form-data |

## 📤 بدنه درخواست

```json
{
  "sending_type": "keyword",
  "from_number": "+983000505",
  "message": "سلام {ex_B} م۱ {ex_C}",
  "files[]": "file.xlsx",
  "send_time": "2025-03-12 21:20:02"
}
```

## 📝 پارامترها

| پارامتر      | نوع    | ضروری | توضیحات                                                                         |
|--------------|--------|-------|---------------------------------------------------------------------------------|
| sending_type | string | بله   | نوع ارسال، باید "keyword" باشد                                                  |
| from_number  | string | بله   | شماره فرستنده در فرمت E.164 (مثال: +983000505)                                  |
| message      | string | بله   | محتوای پیام برای ارسال، می‌تواند شامل جای‌گذارها برای داده‌های پویا باشد        |
| files[]      | file   | بله   | فایل حاوی شماره تلفن‌ها و هر داده اضافی مورد نیاز برای جای‌گذارها               |
| send_time    | string | خیر   | زمان مورد نظر برای ارسال پیام در فرمت YYYY-MM-DD HH:MM:SS. منطقه زمانی UTC است. |

### فرمت فایل

فایل آپلود شده باید شماره تلفن‌ها و داده‌های جای‌گذار را در فرمت زیر شامل شود:

#### فرمت اکسل

فایل اکسل باید ستون‌های زیر را داشته باشد:

- ستون A: شماره تلفن‌ها
- ستون B: داده برای جای‌گذار `{ex_B}`
- ستون C: داده برای جای‌گذار `{ex_C}`
- و غیره...

مثال:

```
phone_number |   ex_B    |      ex_C      |
09123456789  |      علی علوی     | آقای   |
09123456788  |      سارا رضایی     | خانم |
```

## 📝 نکات

- `from_number` باید سرشماره معتبری باشد که به حساب شما اختصاص یافته است.
- `send_time` اختیاری است؛ اگر ارائه نشود، پیام فوراً ارسال خواهد شد.
- جای‌گذارها در پیام باید با عناوین ستون‌های فایل مطابقت داشته باشند.
- جای‌گذارها با فرمت `{ex_COLUMN_NAME}` تعریف می‌شوند.

## ✅ پاسخ موفق

```json
{
  "data": {
    "message_outbox_ids": [
      1123544244
    ]
  },
  "meta": {
    "status": true,
    "message": "انجام شد",
    "message_parameters": [],
    "message_code": "200-1"
  }
}
```

## ❌ پاسخ خطا — فایل نامعتبر (422)

```json
{
  "data": null,
  "meta": {
    "status": false,
    "message": "فرمت فایل پشتیبانی نمی‌شود",
    "message_parameters": [],
    "message_code": "400-2",
    "errors": {
      "files": [
        "فرمت فایل پشتیبانی نمی‌شود"
      ]
    }
  }
}
```

## 🧪 نمونه درخواست

```bash
curl --location '{base_url}/api/send' \
--header 'Authorization: API TOKEN' \
--form 'sending_type="keyword"' \
--form 'from_number="+983000505"' \
--form 'message="سلام {ex_B} م۱ {ex_C}"' \
--form 'files[]=@"path/to/your/file.xlsx"' \
--form 'send_time="2025-03-12 21:20:02"'
```
